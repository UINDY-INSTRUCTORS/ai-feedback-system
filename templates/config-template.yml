# AI Feedback System - Per-Assignment Configuration
# Copy this into each assignment repo and customize

# === BASIC SETTINGS (customize these) ===

assignment:
  name: "Lab 1: Amplifier Design"
  course: "EENG 320"
  type: "lab"  # lab, project, assignment, quiz

report:
  filename: "index.qmd"  # Where is the student's report?
  format: "quarto"       # quarto, markdown, jupyter, latex

# === RUBRIC SETTINGS ===

rubric:
  file: "rubric.yml"  # Rubric file in same directory

  # How many total points?
  total_points: 120  # Optional: calculated from rubric if not specified

# === GUIDANCE SETTINGS ===

guidance:
  file: "guidance.md"  # Guidance file in same directory

  # Feedback style
  tone: "constructive"     # constructive, formal, encouraging
  specificity: "high"      # high, medium, low
  include_examples: true

# === FEEDBACK SETTINGS ===

feedback:
  # Scoring mode (formative assessment vs grading)
  scoring_enabled: false   # If true, AI assigns numerical scores
                           # If false (default), focuses on rubric levels only
                           # Recommended: false for formative assessment

  # Rubric levels will always be reported (e.g., Exemplary, Satisfactory, etc.)
  # Numerical scores are optional and should be disabled for formative feedback

# === AI MODEL SETTINGS ===

model:
  primary: "gpt-4o"
  fallback: "gpt-4o-mini"

  # Enterprise GitHub Models limits (adjust if you have different tier)
  max_concurrent_requests: 2

# === GITHUB ISSUE SETTINGS ===

issue:
  enabled: true
  label: "ai-feedback"
  title: "AI Feedback: {assignment_name}"

# === ADVANCED SETTINGS (usually don't need to change) ===

analysis:
  strategy: "criterion-based"  # criterion-based or full-report
  parallel: true
  max_workers: 2

features:
  code_analysis: true
  figure_checking: true
  citation_checking: true

# === VISION SETTINGS (for analyzing plots and diagrams) ===

vision:
  # Enable vision analysis for images in reports
  enabled: true

  # Criteria to use vision for (by criterion_id)
  # Vision uses tokens but can cause 413 errors if not limited
  criteria:
    - "results"
    - "implementation"

  # Max image dimension to resize to (reduces file size and prevents 413 errors)
  # Recommended: 512-768 to keep quality while avoiding payload size issues
  # 768px allows good readability while reducing base64 size by ~50%
  # Set to null to disable resizing (not recommended - can cause 413 errors)
  resize_max_dimension: 768

  # Max images per criterion (to avoid 413 Payload Too Large errors)
  # CRITICAL: Setting this to 3+ caused the previous 413 error
  # Recommended: 1-2 images per criterion
  max_images_per_criterion: 2

  # Maximum token budget for images (per criterion)
  # Used by filter_images_by_token_budget to select which images to include
  # At 768px resize, most plots use 255-500 tokens
  # Recommended: 1000-2000 tokens to stay well within HTTP limits
  image_token_budget: 1500

  # Auto-detect images if criterion has vision enabled
  auto_detect: true

  # Image priority keywords (higher priority = earlier in list)
  # Images matching these keywords are selected first
  image_priority:
    - "result"
    - "plot"
    - "graph"
    - "diagram"
    - "schematic"
